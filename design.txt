1. parse the CSV 

  CSV -> Vector MRecord

2. filter by loinc

  -> Vector MRecord

3. filter by non-numiric test value

  -> Vector MRecord

4. group by patient 

  Vector MRecord -> Map Int (Vector MRecord)

5. aggregate by patient

  Map Int (Vector MRecord) -> Vector MOut

  5.1. aggregate by averaging test values for each individual month

    Vector MRecord -> Vector MOut

    5.1.2. filter out records with empty months

      Vector MRecord -> Vector MRecord

    5.1.3. group by month

      Vector MRecord -> Map Int (Vector MRecord)

    5.1.4. maybe average test values in each month bucket, get rid of Nothings

      Map Int (Vector MRecord) -> Vector Mout




6. aggregate test values by month around pivot

  Vector MOut -> Vector (TestValue, TestValue)

7. aggregate test values by patient

  Vector (TestValue, TestValue) -> (TestValue, TestValue)



desired flow for collapsed pivot:

1. parse CSV

2. aggregate by month

  2.1. filter out empty months

  2.2. filter out non-numeric test results

  2.3. group by month

  2.4. maybe average test values in each month bucket, get rid of Nothings

3. aggregate monthly test value averages around pivot

